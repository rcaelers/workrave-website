<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=generator content="Hugo 0.109.0"><meta name=robots content="noindex, nofollow"><meta name=description content="Workrave is a program that assists in the recovery and prevention of Repetitive Strain Injury (RSI). The program frequently alerts you to take micro-pauses, rest breaks and restricts you to your daily limit. The program runs on GNU/Linux and Microsoft Windows.
"><link rel="shortcut icon" type=image/x-icon href=/images/favicon.ico><link rel=stylesheet href=https://workrave.org/sass/main.min.ce4ba77d420210f043b2eafed49388defb4f40305be1d398a1ad593d5a932d05.css integrity="sha256-zkunfUICEPBDsur+1JOI3vtPQDBb4dOYoa1ZPVqTLQU=" media=screen><link rel=stylesheet href=https://workrave.org/css/main.min.163e0baf8d5e552480563d39ab81526b5107da66d4ad248880e87497fec53ea8.css integrity="sha256-Fj4Lr41eVSSAVj05q4FSa1EH2mbUrSSIgOh0l/7FPqg=" media=screen><link rel=stylesheet href=https://use.fontawesome.com/releases/v5.7.1/css/all.css integrity=sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr crossorigin=anonymous><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Montserrat:300,400,500&display=swap"><link rel=canonical href=https://workrave.org/bugzilla/124/><title>&#183; Workrave</title></head><body class=bg-light><div class="page-content bg-white"><nav class="navbar fixed-top navbar-expand-lg navbar-light"><div class=container><a class=navbar-brand href=/><img src=/images/workrave-logo.svg alt=Workrave class=page-logo></a>
<button class=navbar-toggler type=button data-toggle=collapse data-target=#mainNavBar aria-controls=mainNavBar aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse" id=mainNavBar><ul class="navbar-nav ml-auto"><li class=nav-item><a class="nav-link text-uppercase" href=/about>About</a></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle text-uppercase" href=# id=navbarDropdown role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false>Get Help</a><div class="dropdown-menu dropdown-menu-right" aria-labelledby=navbarDropdown><a class="dropdown-item text-uppercase" href=/faq/>FAQs</a>
<a class="dropdown-item text-uppercase" href=/docs/>Documentation</a>
<a class="dropdown-item text-uppercase" href=/support/>Support</a></div></li><li class=nav-item><a class="nav-link text-uppercase" href=/contribute>Contribute</a></li><li class=nav-item><a class="nav-link text-uppercase" href=/download/>Downloads</a></li><li class=nav-item><a class="nav-link text-uppercase" href=/blog/>Blog</a></li></ul></div></div></nav><div class="jumbotron jumbotron-fluid banner-style-small"></div><div class="container-lg mt-5 bugzilla" style=max-width:1280px><div class=row><div class="h3 col-md-12 bg-light font-weight-bold">Bug&nbsp;124 - Micropause 'warning' window doesn't move away from cursor</div></div><div class="row py-5"><div class=col-6><div class=row><div class="col-4 text-right font-weight-bold">Status:</div><div class=col-8>RESOLVED WONTFIX</div></div><div class=row><div class="col-4 text-right font-weight-bold">Component:</div><div class=col-8>Core :: Win32</div></div><div class=row><div class="col-4 text-right font-weight-bold">Version:</div><div class=col-8>0.2.0</div></div><div class=row><div class="col-4 text-right font-weight-bold">Hardware:</div><div class=col-8>PC Windows 2000</div></div><div class=row><div class="col-4 text-right font-weight-bold">Importance:</div><div class=col-8>P3 normal</div></div><div class=row><div class="col-4 text-right font-weight-bold">Target Milestone:</div><div class=col-8>---</div></div><div class=row><div class="col-4 text-right font-weight-bold">Assignee:</div><div class=col-8>Raymond Penners</div></div><div class=row><div class="col-4 text-right font-weight-bold">URL:</div><div class=col-8></div></div><div class=row><div class="col-4 text-right font-weight-bold">Depends on:</div><div class=col-8></div></div><div class=row><div class="col-4 text-right font-weight-bold">Blocks:</div><div class=col-8></div></div></div><div class=col-6><div class=row><div class="col-4 text-right font-weight-bold">Reported:</div><div class=col-8>Oct 4 2002 00:37:05 UTC</div></div><div class=row><div class="col-4 text-right font-weight-bold">by:</div><div class=col-8>Arnaud Gouder</div></div><div class=row><div class="col-4 text-right font-weight-bold">Modified:</div><div class=col-8>Oct 22 2002 01:56:53 UTC</div></div></div></div><div class="row pb-4"><div class=col-12><div class=card><h5 class="card-header p-1" id=history-header><button class="btn btn-light collapsed w-100 text-left" type=button data-toggle=collapse data-target=#history-content aria-expanded=false aria-controls=history-content>
<i class="fa fa-chevron-down pull-right"></i>&nbsp;history</button></h5><div class="collapse p-0" id=history-content aria-labelledby=history-header><div class="card-body p-0"><table class="table table-dark table-bordered mb-0"><thead><tr><th scope=col>Who</th><th scope=col>When</th><th scope=col>What</th><th scope=col>Removed</th><th scope=col>Added</th></tr></thead><tbody><tr><th scope=row rowspan=2>Raymond Penners</th><td rowspan=2>Oct 4 2002 02:03:24 UTC</td><td>status</td><td>NEW</td><td>RESOLVED</td></tr><tr><td>resolution</td><td></td><td>WONTFIX</td></tr><tr><th scope=row rowspan=2>Raymond Penners</th><td rowspan=2>Oct 4 2002 02:48:37 UTC</td><td>status</td><td>RESOLVED</td><td>REOPENED</td></tr><tr><td>resolution</td><td>WONTFIX</td><td></td></tr><tr><th scope=row rowspan=2>Raymond Penners</th><td rowspan=2>Oct 10 2002 11:18:15 UTC</td><td>status</td><td>REOPENED</td><td>RESOLVED</td></tr><tr><td>resolution</td><td></td><td>WONTFIX</td></tr></tbody></table></div></div></div></div></div><div class="row pt-2"><div class=col-12><div class=card><div class="card-header h4 p-2"><div class=float-right>Description</div><div class=float-left>Arnaud Gouder&nbsp;&nbsp;Oct 4 2002 00:37:05 UTC</div></div><div class="card-body p-2"><pre style=white-space:pre-wrap>The Micropause &#39;warning&#39; window, moves away form the mouse cursor, but it 
doesn&#39;t do the same for the &#39;typing&#39; cursor in the active application. So if 
that is in the middle of the screen when the warning window popups, it doesn&#39;t 
move away....</pre></div></div></div></div><div class="row pt-2"><div class=col-12><div class=card><div class="card-header h4 p-2"><div class=float-right>Comment 1</div><div class=float-left>Raymond Penners&nbsp;&nbsp;Oct 4 2002 02:03:24 UTC</div></div><div class="card-body p-2"><pre style=white-space:pre-wrap>Sorry, but this simply cannot be fixed properly. In theory, it is possible to
check if the active window is a standard text area, or textfield, try and fetch
its cursor position and do some evasive manouvers.

In practice, however, most applications do not use the standard widgets for
their edit controls. Consider Emacs, it has its own custom display that draws
its own cursor. Just use Spy&#43;&#43; on Word, Emacs, Mozilla, Studio and Explorer, and
see if you can detect a common text widget ... 

</pre></div></div></div></div><div class="row pt-2"><div class=col-12><div class=card><div class="card-header h4 p-2"><div class=float-right>Comment 2</div><div class=float-left>Raymond Penners&nbsp;&nbsp;Oct 4 2002 02:48:37 UTC</div></div><div class="card-body p-2"><pre style=white-space:pre-wrap>I snooped around a bit, and learned about GetCaretPos(). Perhaps I can put this
at use, but don&#39;t expect _all_ applications to work with it. For example, a guy
at Usenet mentions:

&gt; I am writing a program that needs to popup a menu in any running app at the
&gt; current caret position. Using GetCaretPos() works fine for the majority of
&gt; applications, but a number of apps (in particular MSWord 95) always return
&gt; a (0,0) point regardless of where the caret is. Has anyone else seen this
&gt; behaviour and is there a work around ?</pre></div></div></div></div><div class="row pt-2"><div class=col-12><div class=card><div class="card-header h4 p-2"><div class=float-right>Comment 3</div><div class=float-left>Raymond Penners&nbsp;&nbsp;Oct 10 2002 11:18:15 UTC</div></div><div class="card-body p-2"><pre style=white-space:pre-wrap>Okay, I gave it a spin. Conclusion: it works for Notepad and some standard text
fields, but not for Mozilla, Emacs and lots of other apps. The coordinates
returned are faulty, so I cannot even tell the difference between successful
caret coordinates, and bogus coordinates. This makes it impossible to add this
feature... WONTFIX.

If anybody thinks they can do better than me, try improving this code:

#include &lt;windows.h&gt;

int main(int argc, char* argv[])
{
    while (1) {
      HWND hwnd1 = ::GetForegroundWindow ();
      DWORD a = ::GetWindowThreadProcessId (hwnd1, NULL);
      DWORD b = ::GetCurrentThreadId();
      ::AttachThreadInput (a, b, TRUE);
      HWND hwnd2 = ::GetFocus ();
      POINT pt;
      if (::GetCaretPos ((LPPOINT) &amp;pt))
        {
          ::ClientToScreen (hwnd2, (LPPOINT) &amp;pt);
          ::AttachThreadInput (a, b, FALSE);
          printf(&#34;%d-%d\n&#34;, pt.x, pt.y);
        }
      Sleep(1000);
    }
}

</pre></div></div></div></div><div class="row pb-5"></div></div></div><footer class="container bg-light page-footer"><div class="row my-2"><div class="col-12 col-md text-muted"><img src=/images/workrave-logo.svg alt=Workrave style=width:auto;height:20px>
<small class=d-block>&copy; 2001-2020 Raymond Penners & Rob Caelers</small></div><div class="col-12 col-md text-muted"><small>Unless otherwise stated, all text and images on this website are licensed
under the General Public License version 3 or later.<br>This website is powered by <a href=https://gohugo.io>Hugo</a></small></div></div></footer><script src=https://code.jquery.com/jquery-3.4.1.min.js integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin=anonymous></script>
<script src=https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js integrity=sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo crossorigin=anonymous></script>
<script src=https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js integrity=sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6 crossorigin=anonymous></script>
<script type=text/javascript src=https://workrave.org/js/main.min.428d5e8643be5482cc6cf2fb1c80b2e5625f8df018f53d6474a9f4d58668e74c58b35e455ed592b933e43659cc50dc11f452e947f61df3fd7b137161a785b411.js integrity="sha512-Qo1ehkO+VILMbPL7HICy5WJfjfAY9T1kdKn01YZo50xYs15FXtWSuTPkNlnMUNwR9FLpR/Yd8/17E3Fhp4W0EQ=="></script></body></html>