<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=generator content="Hugo 0.109.0"><meta name=robots content="noindex, nofollow"><meta name=description content="Workrave is a program that assists in the recovery and prevention of Repetitive Strain Injury (RSI). The program frequently alerts you to take micro-pauses, rest breaks and restricts you to your daily limit. The program runs on GNU/Linux and Microsoft Windows.
"><link rel="shortcut icon" type=image/x-icon href=/images/favicon.ico><link rel=stylesheet href=https://workrave.org/sass/main.min.ce4ba77d420210f043b2eafed49388defb4f40305be1d398a1ad593d5a932d05.css integrity="sha256-zkunfUICEPBDsur+1JOI3vtPQDBb4dOYoa1ZPVqTLQU=" media=screen><link rel=stylesheet href=https://workrave.org/css/main.min.163e0baf8d5e552480563d39ab81526b5107da66d4ad248880e87497fec53ea8.css integrity="sha256-Fj4Lr41eVSSAVj05q4FSa1EH2mbUrSSIgOh0l/7FPqg=" media=screen><link rel=stylesheet href=https://use.fontawesome.com/releases/v5.7.1/css/all.css integrity=sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr crossorigin=anonymous><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Montserrat:300,400,500&display=swap"><link rel=canonical href=https://workrave.org/bugzilla/852/><title>&#183; Workrave</title></head><body class=bg-light><div class="page-content bg-white"><nav class="navbar fixed-top navbar-expand-lg navbar-light"><div class=container><a class=navbar-brand href=/><img src=/images/workrave-logo.svg alt=Workrave class=page-logo></a>
<button class=navbar-toggler type=button data-toggle=collapse data-target=#mainNavBar aria-controls=mainNavBar aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse" id=mainNavBar><ul class="navbar-nav ml-auto"><li class=nav-item><a class="nav-link text-uppercase" href=/about>About</a></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle text-uppercase" href=# id=navbarDropdown role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false>Get Help</a><div class="dropdown-menu dropdown-menu-right" aria-labelledby=navbarDropdown><a class="dropdown-item text-uppercase" href=/faq/>FAQs</a>
<a class="dropdown-item text-uppercase" href=/docs/>Documentation</a>
<a class="dropdown-item text-uppercase" href=/support/>Support</a></div></li><li class=nav-item><a class="nav-link text-uppercase" href=/contribute>Contribute</a></li><li class=nav-item><a class="nav-link text-uppercase" href=/download/>Downloads</a></li><li class=nav-item><a class="nav-link text-uppercase" href=/blog/>Blog</a></li></ul></div></div></nav><div class="jumbotron jumbotron-fluid banner-style-small"></div><div class="container-lg mt-5 bugzilla" style=max-width:1280px><div class=row><div class="h3 col-md-12 bg-light font-weight-bold">Bug&nbsp;852 - Workrave does not instlall on Vista 64bit</div></div><div class="row py-5"><div class=col-6><div class=row><div class="col-4 text-right font-weight-bold">Status:</div><div class=col-8>ASSIGNED</div></div><div class=row><div class="col-4 text-right font-weight-bold">Component:</div><div class=col-8>Core :: Win32</div></div><div class=row><div class="col-4 text-right font-weight-bold">Version:</div><div class=col-8>1.9.0</div></div><div class=row><div class="col-4 text-right font-weight-bold">Hardware:</div><div class=col-8>PC Windows Vista</div></div><div class=row><div class="col-4 text-right font-weight-bold">Importance:</div><div class=col-8>P1 blocker</div></div><div class=row><div class="col-4 text-right font-weight-bold">Target Milestone:</div><div class=col-8>---</div></div><div class=row><div class="col-4 text-right font-weight-bold">Assignee:</div><div class=col-8>Raymond Penners</div></div><div class=row><div class="col-4 text-right font-weight-bold">URL:</div><div class=col-8></div></div><div class=row><div class="col-4 text-right font-weight-bold">Depends on:</div><div class=col-8></div></div><div class=row><div class="col-4 text-right font-weight-bold">Blocks:</div><div class=col-8></div></div></div><div class=col-6><div class=row><div class="col-4 text-right font-weight-bold">Reported:</div><div class=col-8>Aug 25 2009 12:45:33 UTC</div></div><div class=row><div class="col-4 text-right font-weight-bold">by:</div><div class=col-8>Frederik Pfisterer</div></div><div class=row><div class="col-4 text-right font-weight-bold">Modified:</div><div class=col-8>Oct 17 2009 10:27:18 UTC</div></div><div class=row><div class="col-4 text-right font-weight-bold">CC List:</div><div class=col-8>Ray Satiro</div></div><div class=row><div class="col-4 text-right font-weight-bold"></div><div class=col-8>Rob Caelers</div></div></div></div><div class="row pb-4"><div class=col-12><div class=card><h5 class="card-header p-1" id=attachments-header><button class="btn btn-light collapsed w-100 text-left" type=button data-toggle=collapse data-target=#attachments-content aria-expanded=false aria-controls=attachments-content>
<i class="fa fa-chevron-down pull-right"></i>&nbsp;Attachments</button></h5><div class=collapse id=attachments-content aria-labelledby=attachments-header><div class="card-body p-0"><table class="table table-dark table-bordered mb-0"><thead><tr><th scope=col>Id</th><th scope=col>Who</th><th scope=col>When</th><th scope=col>Size</th><th scope=col>Type</th></tr></thead><tbody><tr><th scope=row rowspan=2>193</th><td colspan=4><a href=https://workrave.org/bugzilla/attachments/attachment-193.png>unable to register dll</a><br><img src=https://workrave.org/bugzilla/attachments/attachment-193.png class="img-fluid img-thumbnail pt-2" alt="unable to register dll"></td></tr><tr><td>Frederik Pfisterer</td><td>Aug 25 2009 12:45:33 UTC</td><td>55591</td><td>image/png</td></tr><tr><th scope=row rowspan=2>198</th><td colspan=4><a href=https://workrave.org/bugzilla/attachments/attachment-198.txt>File List of the workrave directory in the moment of crashing.</a><tr><td>Frederik Pfisterer</td><td>Oct 17 2009 10:27:18 UTC</td><td>36645</td><td>text/plain</td></tr></tbody></table></div></div></div></div></div><div class="row pb-4"><div class=col-12><div class=card><h5 class="card-header p-1" id=history-header><button class="btn btn-light collapsed w-100 text-left" type=button data-toggle=collapse data-target=#history-content aria-expanded=false aria-controls=history-content>
<i class="fa fa-chevron-down pull-right"></i>&nbsp;history</button></h5><div class="collapse p-0" id=history-content aria-labelledby=history-header><div class="card-body p-0"><table class="table table-dark table-bordered mb-0"><thead><tr><th scope=col>Who</th><th scope=col>When</th><th scope=col>What</th><th scope=col>Removed</th><th scope=col>Added</th></tr></thead><tbody><tr><th scope=row rowspan=1>Rob Caelers</th><td rowspan=1>Sep 19 2009 15:51:29 UTC</td><td>cc</td><td></td><td>Rob Caelers</td></tr><tr><th scope=row rowspan=2>Ray Satiro</th><td rowspan=2>Oct 16 2009 22:48:12 UTC</td><td>cc</td><td></td><td>Ray Satiro</td></tr><tr><td>status</td><td>NEW</td><td>ASSIGNED</td></tr></tbody></table></div></div></div></div></div><div class="row pt-2"><div class=col-12><div class=card><div class="card-header h4 p-2"><div class=float-right>Description</div><div class=float-left>Frederik Pfisterer&nbsp;&nbsp;Aug 25 2009 12:45:33 UTC</div></div><div class="card-body p-2"><pre style=white-space:pre-wrap>Created attachment 193
unable to register dll

When installing Workrave i get the attached Error.

Let me know once a fix is available.
Thanks.</pre></div></div></div></div><div class="row pt-2"><div class=col-12><div class=card><div class="card-header h4 p-2"><div class=float-right>Comment 1</div><div class=float-left>Rob Caelers&nbsp;&nbsp;Sep 19 2009 15:51:29 UTC</div></div><div class="card-body p-2"><pre style=white-space:pre-wrap>I cannot reproduce this problem on 64 bit Vista and Windows 7.

Could you please open a Command Prompt (as Administrator) and run:
regsvr32 &#34;c:\Program Files (x86)\Workrave\lib\workrave-applet64.dll&#34;

Does this give an error?

Could you please try a recent snapshot: http://workrave.org/download/snapshots/20090919/workrave-win32-v1_9-20090919-installer.exe

Thanks</pre></div></div></div></div><div class="row pt-2"><div class=col-12><div class=card><div class="card-header h4 p-2"><div class=float-right>Comment 2</div><div class=float-left>Frederik Pfisterer&nbsp;&nbsp;Sep 19 2009 16:01:55 UTC</div></div><div class="card-body p-2"><pre style=white-space:pre-wrap>Tried with recent snapshot from http://workrave.org/download/snapshots/20090919/workrave-win32-v1_9-20090919-installer.exe

Error still occurs. Used Vista Business 64bit.

Running regsvr32 from commandline gives me an error saying
C:\Windows\system32\regsvr32.exe is not compatible with the running windows version. (Note: i do not have dual boot or anyhting, it&#39;s a regular Dell Latitude with vista 64bit preinstalled)

Thanks for caring,
Fred</pre></div></div></div></div><div class="row pt-2"><div class=col-12><div class=card><div class="card-header h4 p-2"><div class=float-right>Comment 3</div><div class=float-left>Rob Caelers&nbsp;&nbsp;Sep 19 2009 17:49:29 UTC</div></div><div class="card-body p-2"><pre style=white-space:pre-wrap>Weird. Is SP1/2 installed?

How about this?

C:\Windows\SysWOW64\regsvr32.exe &#34;\Program Files (x86)\Workrave\lib\workrave-applet64.dll&#34;</pre></div></div></div></div><div class="row pt-2"><div class=col-12><div class=card><div class="card-header h4 p-2"><div class=float-right>Comment 4</div><div class=float-left>Frederik Pfisterer&nbsp;&nbsp;Sep 20 2009 11:46:48 UTC</div></div><div class="card-body p-2"><pre style=white-space:pre-wrap>C:\Windows\SysWOW64\regsvr32.exe seems to execute fine
however it can&#39;t find
&#34;\Program Files (x86)\Workrave\lib\workrave-applet64.dll&#34;
... of course, because it&#39;s not there.

SP1 is installed.

Thanks,
Fred</pre></div></div></div></div><div class="row pt-2"><div class=col-12><div class=card><div class="card-header h4 p-2"><div class=float-right>Comment 5</div><div class=float-left>Rob Caelers&nbsp;&nbsp;Oct 11 2009 13:27:08 UTC</div></div><div class="card-body p-2"><pre style=white-space:pre-wrap>Weird, If workrave-applet64.dll is not installed in \Program Files (x86)\Workrave\lib, the installers seems to think you are running a 32bit system. Are you starting the Workrave installer is some compatibility mode?</pre></div></div></div></div><div class="row pt-2"><div class=col-12><div class=card><div class="card-header h4 p-2"><div class=float-right>Comment 6</div><div class=float-left>Frederik Pfisterer&nbsp;&nbsp;Oct 11 2009 13:36:46 UTC</div></div><div class="card-body p-2"><pre style=white-space:pre-wrap>No. I&#39;m not running any sort of compatibility mode. I have a lot of 32bit software that woks just fine and the few 64bit apps never made any trouble.
Can&#39;t you test registering it with C:\Windows\SysWOW64\regsvr32.exe first and then use the other one as fallback?</pre></div></div></div></div><div class="row pt-2"><div class=col-12><div class=card><div class="card-header h4 p-2"><div class=float-right>Comment 7</div><div class=float-left>Ray Satiro&nbsp;&nbsp;Oct 16 2009 22:48:12 UTC</div></div><div class="card-body p-2"><pre style=white-space:pre-wrap>Workrave 1.9.0 was tested on Server 2003 x64, Vista x64, and later on Windows 7 x64 (pre-RTM builds). The only known applet issue was missing Deskband2 support to allow for taskbar translucency.

In certain circumstances the applet can fail to install when an older version of it is already running. In some installer revisions I think it had unloaded the applet first but explorer.exe is stubborn and the process sometimes can take a few minutes. If the old applet file handle is not actually released by explorer in time when the installer tries to copy a new applet it will fail and leave a .tmp file.

Failure to install the applet will also happen when the installer is not running with administrator privileges. 

Do you have AV? Kaspersky and AVG sometimes have problems with anything not in their database and can crush a DLL.

I would like to identify what could have caused the issue you describe.

Can you please run the command &#39;winver&#39; and tell us what build you&#39;re running?
Also what language(german?), and what edition (ultimate, home premium, etc.)

Please upload a list of files in your Workrave directory.
If your &#34;program files(x86)&#34; directory is on your C drive for example, you would run this in a command window (all one line):
dir /on /n /s &#34;c:\program files(x86)\workrave&#34; &gt; &#34;%USERPROFILE%\Desktop\workrave_file_list.txt&#34;

Please upload workrave_file_list.txt

Thanks,

Ray</pre></div></div></div></div><div class="row pt-2"><div class=col-12><div class=card><div class="card-header h4 p-2"><div class=float-right>Comment 8</div><div class=float-left>Frederik Pfisterer&nbsp;&nbsp;Oct 17 2009 10:26:25 UTC</div></div><div class="card-body p-2"><pre style=white-space:pre-wrap>Hi Ray,

I have Symantec AV. Tried installing the current snapshot with AV turned off but it still gives me exactly the same error. I do also not have an older version of the applet running because it did not install on the very first try.

Winver gives ma the following data:
MS Winows Vista Business
Version 6.0 (Build 6001: Service Pack 1)
German
Physical Memory: 4.191.276 KB

I attach the workrave_file_list.txt in the state when the error window is open. As soon as the error window is closed all changes are rolled back and the workrave directory is deleted.

Thanks (I really want this software ;-)
Fred</pre></div></div></div></div><div class="row pt-2"><div class=col-12><div class=card><div class="card-header h4 p-2"><div class=float-right>Comment 9</div><div class=float-left>Frederik Pfisterer&nbsp;&nbsp;Oct 17 2009 10:27:18 UTC</div></div><div class="card-body p-2"><pre style=white-space:pre-wrap>Created attachment 198
File List of the workrave directory in the moment of crashing.</pre></div></div></div></div><div class="row pb-5"></div></div></div><footer class="container bg-light page-footer"><div class="row my-2"><div class="col-12 col-md text-muted"><img src=/images/workrave-logo.svg alt=Workrave style=width:auto;height:20px>
<small class=d-block>&copy; 2001-2020 Raymond Penners & Rob Caelers</small></div><div class="col-12 col-md text-muted"><small>Unless otherwise stated, all text and images on this website are licensed
under the General Public License version 3 or later.<br>This website is powered by <a href=https://gohugo.io>Hugo</a></small></div></div></footer><script src=https://code.jquery.com/jquery-3.4.1.min.js integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin=anonymous></script>
<script src=https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js integrity=sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo crossorigin=anonymous></script>
<script src=https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js integrity=sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6 crossorigin=anonymous></script>
<script type=text/javascript src=https://workrave.org/js/main.min.428d5e8643be5482cc6cf2fb1c80b2e5625f8df018f53d6474a9f4d58668e74c58b35e455ed592b933e43659cc50dc11f452e947f61df3fd7b137161a785b411.js integrity="sha512-Qo1ehkO+VILMbPL7HICy5WJfjfAY9T1kdKn01YZo50xYs15FXtWSuTPkNlnMUNwR9FLpR/Yd8/17E3Fhp4W0EQ=="></script></body></html>