<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=generator content="Hugo 0.109.0"><meta name=robots content="noindex, nofollow"><meta name=description content="Workrave is a program that assists in the recovery and prevention of Repetitive Strain Injury (RSI). The program frequently alerts you to take micro-pauses, rest breaks and restricts you to your daily limit. The program runs on GNU/Linux and Microsoft Windows.
"><link rel="shortcut icon" type=image/x-icon href=/images/favicon.ico><link rel=stylesheet href=https://workrave.org/sass/main.min.ce4ba77d420210f043b2eafed49388defb4f40305be1d398a1ad593d5a932d05.css integrity="sha256-zkunfUICEPBDsur+1JOI3vtPQDBb4dOYoa1ZPVqTLQU=" media=screen><link rel=stylesheet href=https://workrave.org/css/main.min.163e0baf8d5e552480563d39ab81526b5107da66d4ad248880e87497fec53ea8.css integrity="sha256-Fj4Lr41eVSSAVj05q4FSa1EH2mbUrSSIgOh0l/7FPqg=" media=screen><link rel=stylesheet href=https://use.fontawesome.com/releases/v5.7.1/css/all.css integrity=sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr crossorigin=anonymous><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Montserrat:300,400,500&display=swap"><link rel=canonical href=https://workrave.org/bugzilla/12/><title>&#183; Workrave</title></head><body class=bg-light><div class="page-content bg-white"><nav class="navbar fixed-top navbar-expand-lg navbar-light"><div class=container><a class=navbar-brand href=/><img src=/images/workrave-logo.svg alt=Workrave class=page-logo></a>
<button class=navbar-toggler type=button data-toggle=collapse data-target=#mainNavBar aria-controls=mainNavBar aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse" id=mainNavBar><ul class="navbar-nav ml-auto"><li class=nav-item><a class="nav-link text-uppercase" href=/about>About</a></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle text-uppercase" href=# id=navbarDropdown role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false>Get Help</a><div class="dropdown-menu dropdown-menu-right" aria-labelledby=navbarDropdown><a class="dropdown-item text-uppercase" href=/faq/>FAQs</a>
<a class="dropdown-item text-uppercase" href=/docs/>Documentation</a>
<a class="dropdown-item text-uppercase" href=/support/>Support</a></div></li><li class=nav-item><a class="nav-link text-uppercase" href=/contribute>Contribute</a></li><li class=nav-item><a class="nav-link text-uppercase" href=/download/>Downloads</a></li><li class=nav-item><a class="nav-link text-uppercase" href=/blog/>Blog</a></li></ul></div></div></nav><div class="jumbotron jumbotron-fluid banner-style-small"></div><div class="container-lg mt-5 bugzilla" style=max-width:1280px><div class=row><div class="h3 col-md-12 bg-light font-weight-bold">Bug&nbsp;12 - Move generic code from gui/gtkmm to a higher level</div></div><div class="row py-5"><div class=col-6><div class=row><div class="col-4 text-right font-weight-bold">Status:</div><div class=col-8>RESOLVED FIXED</div></div><div class=row><div class="col-4 text-right font-weight-bold">Component:</div><div class=col-8>Core</div></div><div class=row><div class="col-4 text-right font-weight-bold">Version:</div><div class=col-8>unspecified</div></div><div class=row><div class="col-4 text-right font-weight-bold">Hardware:</div><div class=col-8>PC All</div></div><div class=row><div class="col-4 text-right font-weight-bold">Importance:</div><div class=col-8>P1 major</div></div><div class=row><div class="col-4 text-right font-weight-bold">Target Milestone:</div><div class=col-8>---</div></div><div class=row><div class="col-4 text-right font-weight-bold">Assignee:</div><div class=col-8>Rob Caelers</div></div><div class=row><div class="col-4 text-right font-weight-bold">URL:</div><div class=col-8></div></div><div class=row><div class="col-4 text-right font-weight-bold">Depends on:</div><div class=col-8></div></div><div class=row><div class="col-4 text-right font-weight-bold">Blocks:</div><div class=col-8></div></div></div><div class=col-6><div class=row><div class="col-4 text-right font-weight-bold">Reported:</div><div class=col-8>Aug 30 2002 23:48:54 UTC</div></div><div class=row><div class="col-4 text-right font-weight-bold">by:</div><div class=col-8>Rob Caelers</div></div><div class=row><div class="col-4 text-right font-weight-bold">Modified:</div><div class=col-8>Sep 7 2002 23:54:50 UTC</div></div></div></div><div class="row pb-4"><div class=col-12><div class=card><h5 class="card-header p-1" id=history-header><button class="btn btn-light collapsed w-100 text-left" type=button data-toggle=collapse data-target=#history-content aria-expanded=false aria-controls=history-content>
<i class="fa fa-chevron-down pull-right"></i>&nbsp;history</button></h5><div class="collapse p-0" id=history-content aria-labelledby=history-header><div class="card-body p-0"><table class="table table-dark table-bordered mb-0"><thead><tr><th scope=col>Who</th><th scope=col>When</th><th scope=col>What</th><th scope=col>Removed</th><th scope=col>Added</th></tr></thead><tbody><tr><th scope=row rowspan=3>Rob Caelers</th><td rowspan=3>Sep 6 2002 23:26:09 UTC</td><td>status</td><td>NEW</td><td>ASSIGNED</td></tr><tr><td>priority</td><td>P2</td><td>P1</td></tr><tr><td>summary</td><td>Move some generics stuff from GUI to Core</td><td>Move generic code from gui/gtkmm to a higher level</td></tr><tr><th scope=row rowspan=2>Rob Caelers</th><td rowspan=2>Sep 7 2002 23:54:50 UTC</td><td>status</td><td>ASSIGNED</td><td>RESOLVED</td></tr><tr><td>resolution</td><td></td><td>FIXED</td></tr></tbody></table></div></div></div></div></div><div class="row pt-2"><div class=col-12><div class=card><div class="card-header h4 p-2"><div class=float-right>Description</div><div class=float-left>Rob Caelers&nbsp;&nbsp;Aug 30 2002 23:48:54 UTC</div></div><div class="card-body p-2"><pre style=white-space:pre-wrap>Some generic code should be moved out of gui layer. E.g. merging of break.
advancing restbreaks etc. The control layer is not supposed to have any
knowledge of what kind of timers exist. It just maintain a numer of identical
timers... So, there should be some generic rules....</pre></div></div></div></div><div class="row pt-2"><div class=col-12><div class=card><div class="card-header h4 p-2"><div class=float-right>Comment 1</div><div class=float-left>Rob Caelers&nbsp;&nbsp;Sep 6 2002 23:26:09 UTC</div></div><div class="card-body p-2"><pre style=white-space:pre-wrap>BreakControl.{cc,hh} and a large part of GUI.{cc.hh} are gtkmm independent.
Generics parts should be moved to workrave/src/ or workrave/gui.

Control.cc: This class should not have any knowledge about specific timers
(breaks). It only knows about a collection of identical Timers. In the (very
far) future, this class may implement a generic/configurable mapping from timer
events to actions (GUI actions, sound, auto-away to ICQ client etc). This also
requires some configurable &#34;break-gluing&#34; (i.e. RB overrides MP, don&#39;t show MP
when RB is imminent). Control.cc should also take care of distributed operation.
(Short summary: no changes on short term)

GUI.cc: This class knows about specific timers/breaks (MP, RB, daily, weekly).
It starts, stops, configures and glues these breaks (see above). It uses the
BreakControl class. GUI.cc is also responsible for generating sounds. This class
might become superfluous when Control.cc implements the generic timer event to
action mapping. GUI.cc will have to be split in 2 classes:
workrave/gui/gtkmm/GUI.cc (inter-thread communication stuff, creation of gtkmm
GUI windows, Gtk::Main::run(), etc) and workrave/src/GUI.cc (toolkit independent
part). Note that workrave/gui/* and workrave/src may ONLY use each others
interface classes.

BreakControl.cc: Only talks to some well-defined interfaces
(BreakWindowInterface, ControlInterface, TimerInterface). GUI toolkit
independent. Probably move to workrave/gui. Requires some minor changes.

Advantages:
- Generation of sound not part of gui/gtkmm
- KDE/Qt port (Ronald: hint hint) can re-use a lot of code.

GUIs that want to do thing differently can bypass src/GUI.cc and BreakControl.cc</pre></div></div></div></div><div class="row pt-2"><div class=col-12><div class=card><div class="card-header h4 p-2"><div class=float-right>Comment 2</div><div class=float-left>Rob Caelers&nbsp;&nbsp;Sep 6 2002 23:32:00 UTC</div></div><div class="card-body p-2"><pre style=white-space:pre-wrap>Splitting GUI.cc is not as easy as it seems.... Some GUI independent processing
should be done on the GUI thread (access to the Configurator). Perhaps this is
also a good time to merge some threads....</pre></div></div></div></div><div class="row pt-2"><div class=col-12><div class=card><div class="card-header h4 p-2"><div class=float-right>Comment 3</div><div class=float-left>Rob Caelers&nbsp;&nbsp;Sep 7 2002 23:54:50 UTC</div></div><div class="card-body p-2"><pre style=white-space:pre-wrap>Done. sort of. all files are still in gui/gtkmm. but platform independent stuff
could easily be moved to a higher-level directory. 

BreakControl and GUIControl are Gtkmm independent. Toolkit dependent classes
must implement some interfaces.</pre></div></div></div></div><div class="row pb-5"></div></div></div><footer class="container bg-light page-footer"><div class="row my-2"><div class="col-12 col-md text-muted"><img src=/images/workrave-logo.svg alt=Workrave style=width:auto;height:20px>
<small class=d-block>&copy; 2001-2020 Raymond Penners & Rob Caelers</small></div><div class="col-12 col-md text-muted"><small>Unless otherwise stated, all text and images on this website are licensed
under the General Public License version 3 or later.<br>This website is powered by <a href=https://gohugo.io>Hugo</a></small></div></div></footer><script src=https://code.jquery.com/jquery-3.4.1.min.js integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin=anonymous></script>
<script src=https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js integrity=sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo crossorigin=anonymous></script>
<script src=https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js integrity=sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6 crossorigin=anonymous></script>
<script type=text/javascript src=https://workrave.org/js/main.min.428d5e8643be5482cc6cf2fb1c80b2e5625f8df018f53d6474a9f4d58668e74c58b35e455ed592b933e43659cc50dc11f452e947f61df3fd7b137161a785b411.js integrity="sha512-Qo1ehkO+VILMbPL7HICy5WJfjfAY9T1kdKn01YZo50xYs15FXtWSuTPkNlnMUNwR9FLpR/Yd8/17E3Fhp4W0EQ=="></script></body></html>